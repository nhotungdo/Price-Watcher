@page
@model PriceWatcher.Pages.MultiSearchModel
@{
    ViewData["Title"] = "T√¨m ki·∫øm ƒëa s√†n - So s√°nh gi√° Shopee, Lazada, Tiki";
}

@section Styles {
    <link rel="stylesheet" href="~/css/multi-search.css" asp-append-version="true" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
}

<div class="container py-4">
    <!-- Search Header -->
    <div class="row mb-4">
        <div class="col-12">
            <h1 class="h3 mb-3">üîç T√¨m ki·∫øm & So s√°nh gi√°</h1>
            <p class="text-muted">T√¨m ki·∫øm s·∫£n ph·∫©m tr√™n Shopee, Lazada, Tiki v√† so s√°nh gi√° t·ªët nh·∫•t</p>
        </div>
    </div>

    <!-- Search Box -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card shadow-sm">
                <div class="card-body">
                    <div class="input-group input-group-lg">
                        <input type="text" 
                               id="searchKeyword" 
                               class="form-control" 
                               placeholder="Nh·∫≠p t√™n s·∫£n ph·∫©m c·∫ßn t√¨m..."
                               value="@Model.Keyword">
                        <button class="btn btn-primary px-4" type="button" id="btnSearch">
                            <i class="bi bi-search"></i> T√¨m ki·∫øm
                        </button>
                    </div>
                    
                    <!-- Platform Selection -->
                    <div class="mt-3">
                        <label class="form-label fw-bold">Ch·ªçn s√†n th∆∞∆°ng m·∫°i:</label>
                        <div class="btn-group" role="group">
                            <input type="checkbox" class="btn-check" id="platform-shopee" value="shopee" checked>
                            <label class="btn btn-outline-primary" for="platform-shopee">
                                <img src="/images/platforms/shopee-icon.png" alt="Shopee" style="height: 20px;" class="me-1">
                                Shopee
                            </label>

                            <input type="checkbox" class="btn-check" id="platform-lazada" value="lazada" checked>
                            <label class="btn btn-outline-primary" for="platform-lazada">
                                <img src="/images/platforms/lazada-icon.png" alt="Lazada" style="height: 20px;" class="me-1">
                                Lazada
                            </label>

                            <input type="checkbox" class="btn-check" id="platform-tiki" value="tiki" checked>
                            <label class="btn btn-outline-primary" for="platform-tiki">
                                <img src="/images/platforms/tiki-icon.png" alt="Tiki" style="height: 20px;" class="me-1">
                                Tiki
                            </label>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Filters & Sort -->
    <div class="row mb-3">
        <div class="col-12">
            <div class="d-flex flex-wrap gap-2 align-items-center">
                <!-- Price Filter -->
                <div class="dropdown">
                    <button class="btn btn-outline-secondary dropdown-toggle" type="button" id="priceFilter" data-bs-toggle="dropdown">
                        <i class="bi bi-funnel"></i> Kho·∫£ng gi√°
                    </button>
                    <ul class="dropdown-menu" aria-labelledby="priceFilter">
                        <li><a class="dropdown-item price-range" href="#" data-min="0" data-max="2000000">D∆∞·ªõi 2 tri·ªáu</a></li>
                        <li><a class="dropdown-item price-range" href="#" data-min="2000000" data-max="5000000">2 - 5 tri·ªáu</a></li>
                        <li><a class="dropdown-item price-range" href="#" data-min="5000000" data-max="10000000">5 - 10 tri·ªáu</a></li>
                        <li><a class="dropdown-item price-range" href="#" data-min="10000000" data-max="999999999">Tr√™n 10 tri·ªáu</a></li>
                        <li><hr class="dropdown-divider"></li>
                        <li><a class="dropdown-item price-range" href="#" data-min="" data-max="">T·∫•t c·∫£</a></li>
                    </ul>
                </div>

                <!-- Sort -->
                <div class="dropdown">
                    <button class="btn btn-outline-secondary dropdown-toggle" type="button" id="sortBy" data-bs-toggle="dropdown">
                        <i class="bi bi-sort-down"></i> S·∫Øp x·∫øp
                    </button>
                    <ul class="dropdown-menu" aria-labelledby="sortBy">
                        <li><a class="dropdown-item sort-option" href="#" data-sort="">Li√™n quan</a></li>
                        <li><a class="dropdown-item sort-option" href="#" data-sort="price_asc">Gi√° th·∫•p ƒë·∫øn cao</a></li>
                        <li><a class="dropdown-item sort-option" href="#" data-sort="price_desc">Gi√° cao ƒë·∫øn th·∫•p</a></li>
                        <li><a class="dropdown-item sort-option" href="#" data-sort="rating">ƒê√°nh gi√° cao</a></li>
                        <li><a class="dropdown-item sort-option" href="#" data-sort="sold">B√°n ch·∫°y</a></li>
                        <li><a class="dropdown-item sort-option" href="#" data-sort="discount">Gi·∫£m gi√° nhi·ªÅu</a></li>
                    </ul>
                </div>

                <!-- Additional Filters -->
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="filterFreeShip">
                    <label class="form-check-label" for="filterFreeShip">
                        Freeship
                    </label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="filterOfficial">
                    <label class="form-check-label" for="filterOfficial">
                        Ch√≠nh h√£ng
                    </label>
                </div>

                <div class="ms-auto">
                    <span id="resultCount" class="text-muted"></span>
                </div>
            </div>
        </div>
    </div>

    <!-- Loading Indicator -->
    <div id="loadingIndicator" class="text-center py-5" style="display: none;">
        <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">ƒêang t√¨m ki·∫øm...</span>
        </div>
        <p class="mt-3 text-muted">ƒêang t√¨m ki·∫øm tr√™n c√°c s√†n th∆∞∆°ng m·∫°i...</p>
    </div>

    <!-- Results -->
    <div id="searchResults" class="row g-3">
        <!-- Products will be loaded here -->
    </div>

    <!-- No Results -->
    <div id="noResults" class="text-center py-5" style="display: none;">
        <i class="bi bi-search" style="font-size: 4rem; color: #ccc;"></i>
        <h4 class="mt-3">Kh√¥ng t√¨m th·∫•y s·∫£n ph·∫©m</h4>
        <p class="text-muted">Vui l√≤ng th·ª≠ t·ª´ kh√≥a kh√°c ho·∫∑c ƒëi·ªÅu ch·ªânh b·ªô l·ªçc</p>
    </div>

    <!-- Price Comparison Section -->
    <div id="priceComparisonSection" class="mt-5" style="display: none;">
        <h3 class="h5 mb-3">üìä So s√°nh gi√° s·∫£n ph·∫©m t∆∞∆°ng t·ª±</h3>
        <div id="priceComparisonResults"></div>
    </div>
</div>

@section Scripts {
    <script src="/js/multi-search.js"></script>
}
